NPU task
========


Макросы контекста пакета
-------------------------
======== =========
Макрос   Значение
======== =========
-------- ---------
HEADER   Адрес памяти, хранящей заголовок пакета (размер 80 байт)
-------- ---------
PHV      Адрес памяти, хранящей вектор полей разобранного заголовка
-------- ---------
PORTMASK Адрес памяти, хранящей маску выходных портов для пакета
======== =========


Инструкции парсера
------------------
Парсер имеет два 64-битных регистра r1 и r2.

+--------+------------+------------+----------+
|store   | <PHV>      | <HEADER>   | <length> |
+--------+------------+------------+----------+
|mov     | <register>/|<value>/    |<length>  |
|        | <memory>   |<register>/ |          |
|        |            |<PHV>       |          |
+--------+------------+------------+----------+
|cmpje   | <register> | <value>    | <label>  |
+--------+------------+------------+----------+
|cmpjn   | <register> | <value>    | <label>  |
+--------+------------+------------+----------+
| j      | <label>    |            |          |
+--------+------------+------------+----------+

Инструкции Match-Action
-----------------------
Блоки данного типа имеют 3 64-битных регистра r1, r2, r3.

+--------+------------+------------+----------+
|mov     | <register>/|<value>/    |<length>  |
|        | <memory>   |<register>/ |          |
|        |            |<memory>    |          |
+--------+------------+------------+----------+
|or      | <register>/|<value>/    |          |
|        | <memory>   |<register>  |          |
+--------+------------+------------+----------+
|and     | <register>/|<value>/    |          |
|        | <memory>   |<register>  |          |
+--------+------------+------------+----------+
|xor     | <register>/|<value>/    |          |
|        | <memory>   |<register>  |          |
+--------+------------+------------+----------+
|shl     | <register> |<value>     |          |
+--------+------------+------------+----------+
|shr     | <register> |<value>     |          |
+--------+------------+------------+----------+
|cmpje   | <register> | <value>    | <label>  |
+--------+------------+------------+----------+
|cmpjn   | <register> | <value>    | <label>  |
+--------+------------+------------+----------+
| j      | <label>    |            |          |
+--------+------------+------------+----------+
| call   | <procedure>|            |          |
+--------+------------+------------+----------+

Инструкции депарсера
--------------------
+--------+------------+---------+----------+
|load    | <header>   | <phv>   | <length> |
+--------+------------+---------+----------+
